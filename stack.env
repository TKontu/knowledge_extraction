# ============================================
# Knowledge Extraction Orchestrator - Stack Environment
# ============================================
# Copy this to Portainer's environment variables section
# Variables marked [REQUIRED] must be set
# Variables marked [OPTIONAL] have defaults shown

# ===================
# REQUIRED - Container Registry
# ===================
REGISTRY_PREFIX=ghcr.io/tkontu

# ===================
# REQUIRED - Security (OVERRIDE IN PORTAINER)
# ===================
# API_KEY=<SET_IN_PORTAINER_SECRETS>
# IMPORTANT: Do NOT use this default in production!
# Override this in Portainer with a secure 32+ character key
API_KEY=defaultdevlopapikey32characterslong

# ===================
# REQUIRED - LLM Configuration (OVERRIDE IN PORTAINER)
# ===================
# OPENAI_BASE_URL=<SET_IN_PORTAINER_SECRETS>
# OPENAI_EMBEDDING_BASE_URL=<SET_IN_PORTAINER_SECRETS>
# IMPORTANT: Set these to your actual LLM server URLs in Portainer
OPENAI_BASE_URL=http://localhost:9003/v1
OPENAI_EMBEDDING_BASE_URL=http://localhost:9003/v1
OPENAI_API_KEY=ollama
LLM_MODEL=gemma3-12b-awq
RAG_EMBEDDING_MODEL=bge-large-en

# ===================
# [OPTIONAL] Database (defaults: scristill)
# ===================
# DB_USER=scristill
# DB_PASSWORD=scristill
# DB_NAME=scristill

# ===================
# [OPTIONAL] LLM Timeouts
# ===================
# LLM_HTTP_TIMEOUT=900
# LLM_MAX_RETRIES=5
# LLM_RETRY_BACKOFF_MIN=2
# LLM_RETRY_BACKOFF_MAX=60

# ===================
# [OPTIONAL] Scraping Config
# ===================
# SCRAPE_DELAY_MIN=2
# SCRAPE_DELAY_MAX=5
# SCRAPE_MAX_CONCURRENT_PER_DOMAIN=2
# SCRAPE_DAILY_LIMIT_PER_DOMAIN=500
# SCRAPE_MAX_RETRIES=3
# SCRAPE_TIMEOUT=60

# ===================
# [OPTIONAL] Network/Security
# ===================
# PIPELINE_PORT=8742
# ALLOWED_ORIGINS=*

# ===================
# [OPTIONAL] Anti-Bot Protection
# ===================
# USE_FLARESOLVERR=true
# FLARESOLVERR_LOG_LEVEL=info
# CAPTCHA_SOLVER=none

# ===================
# [OPTIONAL] FlareSolverr Proxy Adapter
# ===================
# PROXY_ADAPTER_ENABLED=true
# PROXY_ADAPTER_PORT=8192
# PROXY_ADAPTER_LOG_LEVEL=INFO
# FLARESOLVERR_URL=http://flaresolverr:8191
# FLARESOLVERR_MAX_TIMEOUT=60000
# FLARESOLVERR_BLOCKED_DOMAINS=weg.net,siemens.com,wattdrive.com

# ===================
# REQUIRED - Playwright Proxy Configuration (for Akamai bypass)
# ===================
PLAYWRIGHT_PROXY_SERVER=http://proxy-adapter:8192
# NOTE: Use hostname (proxy-adapter) not IP address.
# Only use IP address (http://172.x.x.x:8192) if DNS resolution fails in your environment.

# ===================
# [OPTIONAL] Camoufox Browser Service (anti-bot protected scraping)
# ===================
# CAMOUFOX_POOL_SIZE=10        # Max concurrent browser pages
# CAMOUFOX_TIMEOUT=60000       # Page timeout in milliseconds
# CAMOUFOX_PROXY=              # Optional proxy URL (e.g., http://user:pass@host:port)
# CAMOUFOX_HEADLESS=true       # Run headless (set false for debugging)
#
# Migration: To switch Firecrawl from Playwright to Camoufox:
# 1. Build and test: docker compose build camoufox && docker compose up camoufox
# 2. Test endpoint: curl http://localhost:3004/health
# 3. Update firecrawl-api environment:
#    PLAYWRIGHT_MICROSERVICE_URL=http://camoufox:3003/scrape
# 4. Remove HTTP_PROXY/HTTPS_PROXY from firecrawl-api (Camoufox handles anti-bot directly)

# ===================
# [OPTIONAL] Extraction Concurrency
# ===================
# EXTRACTION_MAX_CONCURRENT_CHUNKS=25

# ===================
# [OPTIONAL] File Paths (bind mounts)
# ===================
# INPUT_PATH=/path/to/input
# OUTPUT_PATH=/path/to/output

# ===================
# [OPTIONAL] Logging
# ===================
LOG_LEVEL=INFO
LOG_FORMAT=json
# ENABLE_METRICS=true
